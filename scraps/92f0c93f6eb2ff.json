{
  "title": "Oracle のメモ",
  "closed": false,
  "archived": false,
  "created_at": "2024-12-23",
  "comments": [
    {
      "author": "eggc",
      "created_at": "2024-12-23",
      "body_markdown": "ユーザ一覧（データベース一覧）\n\n```sql\nSELECT USERNAME FROM DBA_USERS ORDER BY USERNAME;\n```"
    },
    {
      "author": "eggc",
      "created_at": "2024-12-23",
      "body_markdown": "インポート実行する前にスキーマ一覧を確認する\n\n```bash\nimpdp SYSTEM/${ORACLE_PWD}@FREEPDB1 SQLFILE=ddl_preview.sql  CONTENT=METADATA_ONLY DIRECTORY=<dump_dir> DUMPFILE=<dumpfile.dmp>\n```",
      "body_updated_at": "2024-12-23"
    },
    {
      "author": "eggc",
      "created_at": "2024-12-23",
      "body_markdown": "dev ユーザから test ユーザへテーブルをコピーする\n\n```sql\nDROP TABLE test.schema_migrations\nCREATE TABLE test.schema_migrations AS SELECT * FROM dev.schema_migrations;\n```",
      "body_updated_at": "2024-12-23"
    },
    {
      "author": "eggc",
      "created_at": "2024-12-23",
      "body_markdown": "セッションタイムゾーンとDBタイムゾーン\n\n```sql\nSELECT SESSIONTIMEZONE FROM DUAL;\nSELECT DBTIMEZONE FROM DUAL;\n```\n"
    },
    {
      "author": "eggc",
      "created_at": "2024-12-26",
      "body_markdown": "PL/SQL\n\n## 基礎\n\n```sql\n-- これをやらないと DBMS_OUTPUT によるプリントデバッグができない\nSET SERVEROUTPUT ON;\n\n-- begin は PL/SQL の開始構文であり、トランザクションではない\nBEGIN\n  -- 文字列 test を出力する\n  DBMS_OUTPUT.PUT_LINE('test');\nEND;\n```\n\n## パッケージの定義・関数の定義\n\n以下の手順でパッケージに関数を定義することができる。\n`/` はこれより上の文を実行するという意味がある。これを書かないとエラーになる。\n\n```sql\n-- パッケージ仕様の宣言\nCREATE OR REPLACE PACKAGE my_package AS\n  FUNCTION new_function (param IN VARCHAR2) RETURN NUMBER;\nEND my_package;\n/\n\n-- パッケージ本体の宣言\nCREATE OR REPLACE PACKAGE BODY my_package AS\n  FUNCTION new_function (param IN VARCHAR2) RETURN NUMBER IS\n  BEGIN\n    DBMS_OUTPUT.PUT_LINE('Length: ' || LENGTH(param));\n    RETURN LENGTH(param);\n  END new_function;\nEND my_package;\n/\n```\n\n## 関数を実行する\n\n```sql\nselect my_package.new_function('hogehoge'); #=> 8\n```\n\n関数とプロシージャはほぼ同じだが\n\n- 関数：戻り値がある\n- プロシージャ：戻り値がない（その代わりになんらかの副作用がある）\n",
      "body_updated_at": "2024-12-26"
    }
  ]
}